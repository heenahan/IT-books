# 01 장

## 1. 자바 8 - 자바 역사상 가장 큰 변화

멀티코어 CPU 대중화와 같은 하드웨어적 변화가 자바 8에 영향을 미쳤다.

전통적인 자바 프로그램은 많은 코어 중 중 하나만을 사용하면서 나머지 코어를 낭비시키는 것이 문제였다.

자바 8이 등장하기 이전에는 병렬 실행을 위해 스레드를 사용했지만 스레드를 사용하면 관리하기 어렵고 많은 문제가 발생할 수 있다.

자바 8이 등장하고 간결한 코드, 멀티코어 프로세서의 쉬운 활용이라는 두 가지 요구사항을 만족하였다.

## 2. 자바 8 설계의 밑바탕
### 2.1. 스트림 처리
자바 8에 추가된 스트림 API의 핵심은 기존에는 한 번에 한 항목을 처리했지만 작업을 일련의 스트림으로 만들어 처리할 수 있다는 것이다.

또한 스트림 파이프라인을 이용해서 입력 부분을 여러 CPU 코어에 쉽게 할당할 수 있다.

결국 스레드라는 복잡한 작업 없이 **공짜**로 병렬성를 이용한다.

### 2.2. 동작 파라미터화
자바 8에서는 메서드를 다른 메서드의 인수로 넘겨주는 **동작 파라미터화** 기능을 제공한다.

동작 파라미터화는 스트림 API가 _연산의 동작_ 을 _파라미터화_ 할 수 있는 코드를 전달한다는 사상에 기초하였기 때문에 중요하다.

### 2.3. 공유되지 않는 가변 데이터
스트림 메서드로 전달하는 코드가 다른 코드와 동시에 실행될 때 **안전하게 실행**할 수 있는 방법은 무엇일까? 두 프로세스가 공유된 가변 데이터에 동시에 접근하지 않아야 한다.

기존에 ```synchronized```를 이용해서 공유된 가변데이터를 보호하는 규칙을 만들었다. 멀티코어 프로세서에서 ```synchronized```를 사용하면 코드가 순차적으로 실행되어야 하므로 병렬이라는 목적을 무력화시켜 훨씬 비싼 비용을 치러야 한다.

📌 공유되지 않는 가변 데이터 그리고 메서드와 함수 코드를 다른 메서드로 전달하는 두 가지 기능은 **함수형 프로그래밍** 패러다임의 핵심적인 사항이다. 스트림 API는 이 두 가지 아이디어를 모두 활용한다.

## 3. 자바 8에서 메서드와 람다
자바 8 설계자들은 메서드를 이급 시민에서 일급 시민으로 바꾸었다. **메서드 참조**는 자바 8의 새로운 기능으로 메서드를 값으로 취급할 수 있는 기능이다.

객체 참조(new로 객체 참조를 생성)를 이용해서 객체를 이리저리 주고 받았던 것처럼 자바 8에서는 메서드를 전달할 수 있게 되었다.

또한 람다를 포함하여 함수도 일급값으로 취급할 수 있다.

## 4. 스트림
### 4.1. 컬렉션 vs 스트림
스트림 API는 컬렉션 API와는 상당히 다른 방식으로 데이터를 처리한다.

컬렉션 API에서는 **직접** for-each 루프를 이용해서 각 요소를 반복하면서 작업을 수행했다. 반면 스트림 API를 이용하면 루프를 신경 쓸 필요 없이 라이브러리 내부에서 모든 데이터가 처리된다.

또한 컬렉션을 이용하여 많은 요소를 가진 목록을 반복하는 작업을 수행했을 때 문제가 발생할 수 있다. 단일 CPU로 거대한 데이터를 처리한다면 매우 오랜 시간이 걸릴 것이다.

하지만 단일 CPU가 아닌 둘 이상의 서로 다른 CPU 코어에 작업을 각각 할당한다면 처리 시간이 줄어든다.

### 4.2. 스트림 API가 해결한 문제
앞에서 말했듯이, 스레드 API로 멀티스레딩을 구현해서 병렬성을 이용하는 것은 어렵다. 스레드를 잘 제어하지 못하면 각각의 스레드가 동시에 공유된 데이터에 접근하고 원치 않는 방식으로 데이터를 바꿀 수 있다.

자바 8의 스트림 API는 _"컬렉션을 처리하면서 발생하는 모호함과 반복적인 코드 문제"_ 그리고 _"멀티코어 활용 어려움"_ 이라는 두 가지 문제를 모두 해결했다.

## 5. 디폴트 메서드
자바 8이 등장하기 전까지는 패키지의 인터페이스를 변경하려면 인터페이스를 구현하는 모든 클래스의 구현을 바꿔야 했다.

자바 8에서는 미래에 프로그램이 쉽게 변화할 수 있도록 인터페이스를 **쉽게 바꿀 수 있는** 디폴트 메서드를 지원한다.

## 6. 그 외 - 자바 8의 함수형 프로그래밍
자바 8에서는 NullPointer 예외를 피할 수 있도록 도와주는 Optional<T\> 클래스를 제공한다.

또한 자바 8은 구조적 패턴 매칭 기법을 활용한다.

---
💡 **Key word**

함수형 프로그래밍, 병렬성, 스트림 API, 동작 파타미터화, 공유되지 않는 가변 데이터